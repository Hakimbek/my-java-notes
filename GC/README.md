# Java Garbage Collection
In java, garbage means unreferenced objects.

Garbage Collection is process of reclaiming the runtime unused memory automatically. In other words, it is a way to destroy the unused objects.

To do so, we were using free() function in C language and delete() in C++. But, in java it is performed automatically. So, java provides better memory management.

## Advantage of Garbage Collection
- It makes java memory efficient because garbage collector removes the unreferenced objects from heap memory.
- It is automatically done by the garbage collector(a part of JVM) so we don't need to make extra efforts.

# How can an object be unreferenced?

## 1. By nulling a reference:
```java
Employee e = new Employee();  
e = null;
```

## 2. By assigning a reference to another:
```java
Employee e1 = new Employee();  
Employee e2 = new Employee();  
e1 = e2; //now the first object referred by e1 is available for garbage collection  
```

## 3. By anonymous object:
```java
new Employee();  
```

# finalize() method
The finalize() method is invoked each time before the object is garbage collected. This method can be used to perform cleanup processing. This method is defined in Object class as:

```java
protected void finalize(){}  
```
## Note
The Garbage collector of JVM collects only those objects that are created by new keyword. So if you have created any object without new, you can use finalize method to perform cleanup processing (destroying remaining objects).

# gc() method
The gc() method is used to invoke the garbage collector to perform cleanup processing. The gc() is found in System and Runtime classes.

```java
public static void gc(){}  
```

## Note
- Garbage collection is performed by a daemon thread called Garbage Collector(GC). This thread calls the finalize() method before object is garbage collected.
- Neither finalization nor garbage collection is guaranteed.

# Java Shutdown Hook
A special construct that facilitates the developers to add some code that has to be run when the Java Virtual Machine (JVM) is shutting down is known as the Java shutdown hook. The Java shutdown hook comes in very handy in the cases where one needs to perform some special cleanup work when the JVM is shutting down. Note that handling an operation such as invoking a special method before the JVM terminates does not work using a general construct when the JVM is shutting down due to some external factors. For example, whenever a kill request is generated by the operating system or due to resource is not allocated because of the lack of free memory, then in such a case, it is not possible to invoke the procedure. The shutdown hook solves this problem comfortably by providing an arbitrary block of code.

In nutshell, the shutdown hook can be used to perform cleanup resources or save the state when JVM shuts down normally or abruptly. Performing clean resources means closing log files, sending some alerts, or something else. So if you want to execute some code before JVM shuts down, use the shutdown hook.

# When does the JVM shut down?

- user presses ctrl+c on the command prompt
- System.exit(int) method is invoked
- user logoff
- user shutdown etc.

```java
class MyThread extends Thread {    
    public void run() {    
        System.out.println("shut down hook task completed..");    
    }    
}    
    
public class TestShutdown {    
    public static void main(String[] args)throws Exception {    
    
        Runtime r = Runtime.getRuntime();    
        r.addShutdownHook(new MyThread());    
        
        System.out.println("Now main sleeping... press ctrl+c to exit");      
        try {
            Thread.sleep(3000);
        } catch (Exception e) {
        
        }    
    }    
}    
```
### Output:
```
Now main sleeping... press ctrl+c to exit
shut down hook task completed.
```
